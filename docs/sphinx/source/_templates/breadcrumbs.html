{#

Modify the "Edit on Github" links to handle auto-generated pages in the
example gallery and the API reference listings.  The GH links that sphinx
generates by default make the assumption that an HTML file comes from an RST
file with the same filepath, which isn't the case for autogenerated files.

#}

{% extends "!breadcrumbs.html" %}
{% block breadcrumbs_aside %}
    <li class="wy-breadcrumbs-aside">
        {#
        We need to generate the target URL differently based on the type
        of page.  We use the built-in `pagename` variable to determine what
        kind of page this is.  `pagename` is the path at the end of the
        URL, without the extension.  For instance,
        https://pvlib-python.rtfd.org/en/stable/auto_examples/plot_singlediode.html
        will have pagename = "auto_examples/plot_singlediode".
        #}

        {# Is it a gallery page?  If so, "auto_examples" will be in the name #}
        {% if gallery_dir in pagename %}
            {% if pagename.split("/")[-1] == "index" %}
                {% set target_url = "https://github.com/pvlib/pvlib-python/blob/master/docs/examples/README.rst" %}
            {% else %}
                {% set example_script = pagename.split("/")[-1] + ".py" %}
                {% set target_url = "https://github.com/pvlib/pvlib-python/blob/master/docs/examples/" + example_script %}
            {% endif %}

        {# Is it an API autogen page?  If so, pagename looks like "generated/pvlib.location.Location" #}
        {% elif "generated" in pagename %}
            {# use our make_url function defined in conf.py #}
            {% set target_url = make_url(pagename.split("/")[-1]) %}

        {# Just a normal source RST page #}
        {% else %}
            {% set target_url = "https://github.com/pvlib/pvlib-python/blob/master/docs/sphinx/source/" + pagename + ".rst" %}

        {% endif %}
        {# Create the HTML element with our custom GH link: #}
        <a href="{{ target_url }}" class="fa fa-github">View on Github</a>
    </li>
{% endblock %}
